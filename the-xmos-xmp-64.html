<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="James W. Hanlon">
  <title>The XMOS XMP-64</title>
  <link rel="icon" href="./favicon.png" sizes="16x16" type="image/png">
  <link rel="stylesheet" type="text/css" href="./theme/css/main.css"/>
  <link href="http://jameswhanlon.com/reeds/atom.xml"
      type="application/atom+xml" rel="alternate"
      title="James W. Hanlon Atom Feed" />
  <link href="http://jameswhanlon.com/reeds/rss.xml"
      type="application/rss+xml" rel="alternate"
      title="James W. Hanlon RSS Feed" />
  <!-- Clicky -->
  <script async src="//static.getclicky.com/101392449.js"></script>
  <noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/101392449ns.gif" /></p></noscript>
  <!-- MathJax -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
  </script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML'></script>
</head>
<body>
  <header>
  <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
    <div class="container-fluid">
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarCollapse">
        <ul class="navbar-nav me-auto mb-2 mb-md-0 text-uppercase">
          <li class="nav-item">
              <a class="nav-link" href="/index.html">notes</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="/projects.html">projects</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="/archive.html">archive</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="/about.html">about</a>
          </li>
        </ul>
        <a class="navbar-brand" href="#">James W. Hanlon</a>
      </div>
    </div>
  </nav>
  </header>

  <main class="flex-shrink-0">
  <div class="container">
  <h1>
    The <span class="caps">XMOS</span> <span class="caps">XMP</span>-64
  </h1>
  <div class="lead">
    <time class="published" datetime="2014-12-04T00:00:00+01:00">
      04 Dec 2014
    </time><br>
      <span class="article-tag small"><a href="/tag/computing.html">computing</a></span>
      <span class="article-tag small"><a href="/tag/electronics.html">electronics</a></span>
  </div>
  <div class="article-body">
    <p>The <span class="caps">XMP</span>-64 is an experimental single-board distributed-memory parallel computer
with 512 hardware threads  and is programmable with a C-like language.  It was
developed by <a href="https://www.xmos.com&gt;"><span class="caps">XMOS</span></a> in 2009 to demonstrate the
scalablility of the <a href="https://en.wikipedia.org/wiki/XCore_XS1"><span class="caps">XS1</span> architecture</a>.
Since then it has been <a href="https://www.xmos.com/published/xmp-64-end-life">discontinued</a>
but remains a fascinating device from the point of view of providing a huge amount of
parallelism that is programmable in a simple way. As such, I thought I would
record some details and images of it&nbsp;here.</p>
<p>The <span class="caps">XMP</span>-64 board contains a four-by-four grid of <a href="https://en.wikipedia.org/wiki/XCore_XS1-G"><span class="caps">XS1</span>-G4
chips</a>, each with four processor
cores, and with core providing eight hardware threads. The G4 chips themselves
are connected in an order-four hypercube topology, with every G4 connected
directly to four others. The G4 has 16 links, so four links are used to connect
each direction.  The data rate of each link is 400 Mbits/second, or 1.6
Gbits/second in each edge of the hypercube. The bisection bandwidth of the
entire network is four times this again, at 6.4 Gbits/second. Each processor
core has 64 <span class="caps">KB</span> of <span class="caps">SRAM</span> memory and runs at 400 MHz. The whole <span class="caps">XMP</span>-64 array
therefore provides 512 threads, 4 <span class="caps">MB</span> of memory and a peak performance of 25.6
<span class="caps">GOPS</span>. (There are more details in the performance experiment document linked&nbsp;below)</p>
<p>Since the G4 is an embedded processor, these performance numbers are not
competitive with contemporary <span class="caps">CPU</span> or <span class="caps">GPU</span> devices; it does however burn only a
few tens of watts of power, provides deterministic (completely predictable)
execution of 512 threads and provides a very simple programming&nbsp;interface.</p>
<div class="text-center">
<a href="https://jwh.ams3.digitaloceanspaces.com/homepage/XMP-64/xmp64-1.JPG" data-lightbox="xmp64"><img class="thumbnail rounded" src="thumbs/xmp64-1_320x320.JPG" alt="XMP-64 top"></a>
<a href="https://jwh.ams3.digitaloceanspaces.com/homepage/XMP-64/xmp64-2.JPG" data-lightbox="xmp64"><img class="thumbnail rounded" src="thumbs/xmp64-2_320x320.JPG" alt="XMP-64 bottom"></a>
<a href="https://jwh.ams3.digitaloceanspaces.com/homepage/XMP-64/xmp64-3.JPG" data-lightbox="xmp64"><img class="thumbnail rounded" src="thumbs/xmp64-3_320x320.JPG" alt="XMP-64 top/down"></a>
<a href="https://jwh.ams3.digitaloceanspaces.com/homepage/XMP-64/xmp64-4.JPG" data-lightbox="xmp64"><img class="thumbnail rounded" src="thumbs/xmp64-4_320x320.JPG" alt="XMP-64 left side"></a>
<a href="https://jwh.ams3.digitaloceanspaces.com/homepage/XMP-64/xmp64-5.JPG" data-lightbox="xmp64"><img class="thumbnail rounded" src="thumbs/xmp64-5_320x320.JPG" alt="XMP-64 right side"></a>
<a href="https://jwh.ams3.digitaloceanspaces.com/homepage/XMP-64/xmp64-6.JPG" data-lightbox="xmp64"><img class="thumbnail rounded" src="thumbs/xmp64-6_320x320.JPG" alt="XMP-64 in case"></a>
</div>

<p>As you can see in the pictures, there are two Ethernet interfaces at the top of
the board, which could be used to daisy chain multiple <span class="caps">XMP</span>-64 boards together.
Additionally there are 64-pin headers on either side that expose
general-purpose I/O pins connected directly to processors in the&nbsp;array.</p>
<p>Below is an example program for the <span class="caps">XMP</span>-64 written in
<a href="https://en.wikipedia.org/wiki/XC_(programming_language)"><span class="caps">XC</span></a>, a programming
language based on
<a href="https://en.wikipedia.org/wiki/Occam_(programming_language)">occam</a> designed to
target the features of the <span class="caps">XS1</span> architecture. The program uses a ring topology
of communication channels to connect one thread on each chip. As a token is
passed around, the <span class="caps">LED</span> connected to each G4 is switched on for a short&nbsp;period.</p>
<div class="codehilite"><pre><span></span><span class="err">#</span><span class="nx">include</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">platform</span><span class="p">.</span><span class="nx">h</span><span class="o">&gt;</span>
<span class="err">#</span><span class="nx">include</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">xs1</span><span class="p">.</span><span class="nx">h</span><span class="o">&gt;</span>

<span class="err">#</span><span class="nx">define</span><span class="w"> </span><span class="nx">NUM_CHIPS</span><span class="w"> </span><span class="p">(</span><span class="mf">16</span><span class="p">)</span>
<span class="err">#</span><span class="nx">define</span><span class="w"> </span><span class="nx">STEP</span><span class="w">      </span><span class="p">(</span><span class="mf">4</span><span class="p">)</span>

<span class="nx">out</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="nx">leds</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">on</span><span class="w"> </span><span class="nx">stdcore</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">XS1_PORT_1E</span><span class="p">,</span>
<span class="w">  </span><span class="nx">on</span><span class="w"> </span><span class="nx">stdcore</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">XS1_PORT_1E</span><span class="p">,</span>
<span class="w">  </span><span class="nx">on</span><span class="w"> </span><span class="nx">stdcore</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">XS1_PORT_1E</span><span class="p">,</span>
<span class="w">  </span><span class="nx">on</span><span class="w"> </span><span class="nx">stdcore</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="nx">XS1_PORT_1E</span><span class="p">,</span>
<span class="w">  </span><span class="nx">on</span><span class="w"> </span><span class="nx">stdcore</span><span class="p">[</span><span class="mf">16</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="nx">XS1_PORT_1E</span><span class="p">,</span>
<span class="w">  </span><span class="nx">on</span><span class="w"> </span><span class="nx">stdcore</span><span class="p">[</span><span class="mf">20</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="nx">XS1_PORT_1E</span><span class="p">,</span>
<span class="w">  </span><span class="nx">on</span><span class="w"> </span><span class="nx">stdcore</span><span class="p">[</span><span class="mf">24</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="nx">XS1_PORT_1E</span><span class="p">,</span>
<span class="w">  </span><span class="nx">on</span><span class="w"> </span><span class="nx">stdcore</span><span class="p">[</span><span class="mf">28</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="nx">XS1_PORT_1E</span><span class="p">,</span>
<span class="w">  </span><span class="nx">on</span><span class="w"> </span><span class="nx">stdcore</span><span class="p">[</span><span class="mf">32</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="nx">XS1_PORT_1E</span><span class="p">,</span>
<span class="w">  </span><span class="nx">on</span><span class="w"> </span><span class="nx">stdcore</span><span class="p">[</span><span class="mf">36</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="nx">XS1_PORT_1E</span><span class="p">,</span>
<span class="w">  </span><span class="nx">on</span><span class="w"> </span><span class="nx">stdcore</span><span class="p">[</span><span class="mf">40</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="nx">XS1_PORT_1E</span><span class="p">,</span>
<span class="w">  </span><span class="nx">on</span><span class="w"> </span><span class="nx">stdcore</span><span class="p">[</span><span class="mf">44</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="nx">XS1_PORT_1E</span><span class="p">,</span>
<span class="w">  </span><span class="nx">on</span><span class="w"> </span><span class="nx">stdcore</span><span class="p">[</span><span class="mf">48</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="nx">XS1_PORT_1E</span><span class="p">,</span>
<span class="w">  </span><span class="nx">on</span><span class="w"> </span><span class="nx">stdcore</span><span class="p">[</span><span class="mf">52</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="nx">XS1_PORT_1E</span><span class="p">,</span>
<span class="w">  </span><span class="nx">on</span><span class="w"> </span><span class="nx">stdcore</span><span class="p">[</span><span class="mf">56</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="nx">XS1_PORT_1E</span><span class="p">,</span>
<span class="w">  </span><span class="nx">on</span><span class="w"> </span><span class="nx">stdcore</span><span class="p">[</span><span class="mf">60</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="nx">XS1_PORT_1E</span>
<span class="p">};</span>

<span class="ow">void</span><span class="w"> </span><span class="nx">flash_led</span><span class="p">(</span><span class="kr">int</span><span class="w"> </span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="nx">chanend</span><span class="w"> </span><span class="nx">prev</span><span class="p">,</span><span class="w"> </span><span class="nx">chanend</span><span class="w"> </span><span class="nx">next</span><span class="p">,</span><span class="w"> </span><span class="nx">out</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="nx">led</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">timer</span><span class="w"> </span><span class="nx">t</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">next</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">prev</span><span class="w"> </span><span class="o">:&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="w">    </span><span class="nx">led</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">    </span><span class="nx">delay_milliseconds</span><span class="p">(</span><span class="mf">100</span><span class="p">);</span>
<span class="w">    </span><span class="nx">led</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="nx">next</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kr">int</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">chan</span><span class="w"> </span><span class="nx">c</span><span class="p">[</span><span class="nx">NUM_CHIPS</span><span class="p">];</span>
<span class="w">  </span><span class="nx">par</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">par</span><span class="w"> </span><span class="p">(</span><span class="kr">int</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">NUM_CHIPS</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nx">STEP</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">on</span><span class="w"> </span><span class="nx">stdcore</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">flash_led</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">c</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span><span class="w"> </span><span class="nx">c</span><span class="p">[(</span><span class="nx">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="nx">NUM_CHIPS</span><span class="p">],</span><span class="w"> </span><span class="nx">leds</span><span class="p">[</span><span class="nx">i</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">STEP</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>As an intern at <span class="caps">XMOS</span> in 2009, I did some work to investigate the performance of
the <span class="caps">XMP</span>-64. This is written up in the document linked below. It looks at the
performance of barrier synchronisations and exchanges of various permutations
of source-destination pairs. Sadly though, to my knowledge, the <span class="caps">XMP</span>-64 didn&#8217;t
see much further use or experimental application development. However, a
similar board was developed by the <a href="https://www.cs.bris.ac.uk/home/simon/many-core/Swallow/Swallow.html">Swallow
project</a>,
which used <span class="caps">XS1</span> chips (12 cores per board) and allowed direct expansion of the
network with multiple boards up to 480 cores. See the <a href="http://arxiv.org/pdf/1504.06357.pdf">research
paper</a> (ArXiv) for more&nbsp;details.</p>
<h2>More information and&nbsp;links</h2>
<ul>
<li>
<p><a href="/files/xmp64experiments.pdf"><span class="caps">XMP</span>-64 performance experiments document</a> (<span class="caps">PDF</span>),&nbsp;2010,</p>
</li>
<li>
<p><a href="https://github.com/jameshanlon/xmp64-experiments"><span class="caps">XMP</span>-64 performance experiments source code</a>&nbsp;(GitHub).</p>
</li>
<li>
<p><a href="http://ieeexplore.ieee.org/document/5948572">The <span class="caps">XMOS</span> <span class="caps">XK</span>-<span class="caps">XMP</span>-64 development board</a>, a writeup based on the
  above for the Networks on Chip 2011 symposium, (<span class="caps">IEEE</span>&nbsp;Xplore).</p>
</li>
<li>
<p><a href="https://github.com/xcore/proj_xmp64">Example programs and <span class="caps">PCB</span> design files</a>&nbsp;(GitHub).</p>
</li>
<li>
<p><a href="https://www.xcore.com/wiki/index.php/XK-XMP-64_Development_Board">XCore wiki page</a>.</p>
</li>
<li>
<p><a href="https://www.xmos.com/xmp64"><span class="caps">XK</span>-<span class="caps">XMP</span>-64 Development Board</a> (<span class="caps">XMOS</span>&nbsp;website).</p>
</li>
</ul>
  </div>
  <div class="article-footer">
    <p>Please get in touch (mail @ this domain) with any
    comments, corrections or suggestions.</p>
  </div>
  </div>
  </main>

  <hr>
  <footer class="text-muted">
    <div class="container">
      <div class="small">
        <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
          <img alt="Creative Commons Licence" style="border-width:0"
               src="https://i.creativecommons.org/l/by/4.0/80x15.png" />
        </a><br>
        Unless otherwise noted, all content is freely available under a
        <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
          Creative Commons Attribution 4.0 International License</a>.<br>
        Subscribe: <a href="http://jameswhanlon.com/reeds/atom.xml">Atom</a> /
        <a href="http://jameswhanlon.com/reeds/rss.xml">RSS</a>
      </div>
    </div>
  </footer>
  <script src="./theme/js/bundle.js"></script>
</body>
</html>